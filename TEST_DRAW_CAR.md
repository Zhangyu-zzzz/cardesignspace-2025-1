# 画个车功能测试指南

## 🧪 本地测试步骤

### 1. 启动服务

#### 启动后端
```bash
cd backend
npm start
```

确认看到：
```
服务器运行在端口 3000
所有API路由已加载完成
```

#### 启动前端
```bash
cd frontend
npm run serve
```

访问：http://localhost:8080

### 2. 测试导航

#### 测试导航栏
1. ✅ 查看顶部导航栏是否显示"画个车"
2. ✅ 点击"画个车"，URL 应变为 `/draw-car`
3. ✅ 应该看到欢迎界面，包含：
   - 🚗 标题
   - 3个按钮：开始创作、参观车库、查看排行榜

### 3. 测试绘画功能

#### 进入绘画界面
1. ✅ 点击"开始创作"按钮
2. ✅ 应该看到绘画界面，包含：
   - 左侧控制面板（颜色、画笔大小、操作按钮）
   - 中间白色画布
   - 顶部说明文字

#### 测试绘画工具
1. ✅ 选择不同颜色，在画布上绘画
2. ✅ 调节笔刷大小滑块，测试不同粗细
3. ✅ 点击"撤销"按钮，应该撤销最后一笔
4. ✅ 点击"清空"按钮，画布应该清空
5. ✅ 点击"返回"按钮，应该返回欢迎界面

#### 测试提交流程
1. ✅ 画一个简单的图形（例如：车的轮廓）
2. ✅ 点击"完成创作 ✨"按钮
3. ✅ 应该弹出命名对话框
4. ✅ 输入名称（例如："我的第一辆车"）或点击"跳过"
5. ✅ 点击"确定"
6. ✅ 应该显示成功提示
7. ✅ 自动跳转到车库界面

### 4. 测试车库功能

#### 查看车库
1. ✅ 从欢迎界面点击"参观车库"
2. ✅ 应该看到：
   - 顶部显示"载具数量: X"
   - 画布中显示所有载具
   - 载具在平面上自动移动

#### 测试交互
1. ✅ 观察载具是否在移动
2. ✅ 载具碰到边界是否反弹
3. ✅ 点击任意载具
4. ✅ 应该弹出详情窗口，显示：
   - 载具预览
   - 载具名称
   - 创建时间
   - 评分
   - 点赞/拉踩/举报按钮

#### 测试投票
1. ✅ 点击"👍"按钮
2. ✅ 应该显示"点赞成功"提示
3. ✅ 点赞数应该+1
4. ✅ 再次点击同一载具
5. ✅ 点击"👎"按钮
6. ✅ 应该切换投票类型（点赞-1，拉踩+1）

#### 测试控制
1. ✅ 改变"显示数量"下拉框
2. ✅ 载具数量应该相应变化
3. ✅ 点击"返回首页"，应该回到欢迎界面

### 5. 测试排行榜功能

#### 查看排行榜
1. ✅ 从欢迎界面点击"查看排行榜"
2. ✅ 应该看到网格布局的载具列表
3. ✅ 每个载具卡片显示：
   - 排名序号
   - 载具预览
   - 载具名称
   - 得分

#### 测试排序
1. ✅ 点击"按得分"，应该按 score 降序排列
2. ✅ 点击"按热度"，应该按 (likes + dislikes) 排序
3. ✅ 点击"按日期"，应该按创建时间排序
4. ✅ 点击"随机排序"，应该随机打乱顺序

#### 测试导航
1. ✅ 点击任意载具卡片
2. ✅ 应该跳转到车库界面并选中该载具
3. ✅ 点击"返回首页"，回到欢迎界面
4. ✅ 点击"返回车库"，进入车库界面

### 6. 测试数据持久化

#### 验证数据保存
1. ✅ 创建多个载具
2. ✅ 刷新页面
3. ✅ 进入车库，应该看到之前创建的所有载具
4. ✅ 投票信息应该保持不变

#### 验证数据库
如果可以访问数据库，执行：
```sql
-- 查看载具数据
SELECT id, name, likes, dislikes, score, status, createdAt 
FROM vehicles 
ORDER BY createdAt DESC 
LIMIT 10;

-- 查看投票记录
SELECT * FROM vehicle_votes ORDER BY createdAt DESC LIMIT 10;
```

### 7. 测试边界情况

#### 空画布提交
1. ✅ 不画任何内容，直接点击"完成创作"
2. ✅ 应该能正常提交（虽然是空白载具）

#### 匿名用户
1. ✅ 确保未登录状态
2. ✅ 应该能正常创作和投票

#### 已登录用户
1. ✅ 登录账号
2. ✅ 创建载具
3. ✅ 在数据库中应该看到 userId 字段有值

#### 重复投票
1. ✅ 对同一载具多次点击"👍"
2. ✅ 应该提示"您已经投过这个票了"
3. ✅ 数字不应该重复增加

### 8. 测试响应式设计

#### 移动端测试
1. ✅ 打开浏览器开发者工具
2. ✅ 切换到移动设备模拟
3. ✅ 测试所有功能是否正常
4. ✅ 画布应该适配屏幕大小

### 9. 测试性能

#### 大量载具
1. ✅ 创建 20+ 个载具
2. ✅ 进入车库
3. ✅ 观察动画是否流畅
4. ✅ FPS 应该保持在 30+ 以上

#### 内存使用
1. ✅ 打开浏览器任务管理器
2. ✅ 观察内存使用情况
3. ✅ 长时间运行不应该有明显内存泄漏

## 🐛 常见问题排查

### 问题 1：页面显示空白
- 检查控制台是否有错误
- 确认后端服务是否启动
- 检查数据库表是否创建

### 问题 2：无法创建载具
- 检查后端日志：`pm2 logs auto-gallery-backend`
- 确认 API 端点是否正确：`/api/draw-car/vehicles`
- 检查数据库连接

### 问题 3：投票不生效
- 检查浏览器控制台网络请求
- 确认投票 API 返回状态
- 检查数据库 vehicle_votes 表

### 问题 4：车库动画卡顿
- 减少显示数量
- 检查 CPU 使用率
- 确认 requestAnimationFrame 是否正常工作

### 问题 5：图片无法显示
- 检查 imageData 字段是否包含有效的 base64 数据
- 确认 base64 前缀格式正确：`data:image/png;base64,`

## ✅ 测试检查清单

### 功能测试
- [ ] 导航栏显示正常
- [ ] 绘画工具正常工作
- [ ] 载具创建成功
- [ ] 车库动画流畅
- [ ] 投票功能正常
- [ ] 排行榜排序正确
- [ ] 数据持久化有效

### 兼容性测试
- [ ] Chrome 浏览器
- [ ] Firefox 浏览器
- [ ] Safari 浏览器
- [ ] 移动端浏览器

### 性能测试
- [ ] 页面加载速度 < 3秒
- [ ] 动画帧率 > 30 FPS
- [ ] 内存使用合理
- [ ] 无明显内存泄漏

### 安全测试
- [ ] SQL 注入防护
- [ ] XSS 攻击防护
- [ ] CSRF 防护
- [ ] 重复投票限制

## 📊 预期结果

### 成功标准
1. ✅ 所有核心功能正常工作
2. ✅ 无JavaScript错误
3. ✅ 数据正确保存到数据库
4. ✅ 动画流畅，无卡顿
5. ✅ 响应式设计适配良好

### 性能指标
- 页面加载时间：< 3秒
- API 响应时间：< 500ms
- 动画帧率：> 30 FPS
- 内存使用：< 200MB

## 🚀 下一步

测试通过后：
1. 提交代码到 Git
2. 部署到生产环境
3. 监控生产环境运行状况
4. 收集用户反馈
5. 持续优化改进


