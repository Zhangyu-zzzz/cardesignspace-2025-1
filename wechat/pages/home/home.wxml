<!--pages/home/home.wxml-->
<view class="home-container">
  <!-- 轮播图 -->
  <view class="carousel-section" wx:if="{{carouselItems.length > 0}}">
    <swiper 
      class="carousel-swiper" 
      indicator-dots="{{true}}"
      autoplay="{{true}}"
      interval="{{5000}}"
      duration="{{500}}"
      current="{{currentSlide}}"
      bindchange="goToSlide"
    >
      <swiper-item wx:for="{{carouselItems}}" wx:key="id">
        <view class="carousel-item" bindtap="viewModelDetail" data-id="{{item.id}}">
          <image 
            class="carousel-image" 
            src="{{item.Images && item.Images[0] ? item.Images[0].url : ''}}"
            mode="aspectFill"
            lazy-load="{{true}}"
          />
          <view class="carousel-overlay">
            <view class="carousel-content">
              <text class="carousel-badge">最新上传</text>
              <text class="carousel-title">{{item.name}}</text>
              <text class="carousel-brand">{{item.Brand ? item.Brand.name : '未知品牌'}}</text>
            </view>
          </view>
        </view>
      </swiper-item>
    </swiper>
  </view>

  <!-- 加载状态 -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading">
      <text class="loading-text">加载中...</text>
    </view>
  </view>

  <!-- 错误状态 -->
  <view class="error-container" wx:if="{{error && !loading}}">
    <view class="error">
      <text class="error-text">{{error}}</text>
      <button class="btn-primary mt-20" bindtap="loadData">重试</button>
    </view>
  </view>

  <!-- 中国品牌 -->
  <view class="section" wx:if="{{!loading && !error}}">
    <view class="section-header">
      <text class="section-title">中国品牌</text>
      <text class="section-more" bindtap="onSearch">查看更多</text>
    </view>
    <scroll-view class="brands-scroll" scroll-x="{{true}}" show-scrollbar="{{false}}">
      <view class="brands-list">
        <view 
          class="brand-item" 
          wx:for="{{chineseBrands}}" 
          wx:key="id"
          bindtap="viewBrandDetail"
          data-id="{{item.id}}"
        >
          <image 
            class="brand-logo" 
            src="{{item.logo || '/images/default-brand.png'}}"
            mode="aspectFit"
            lazy-load="{{true}}"
          />
          <text class="brand-name">{{item.name}}</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- 最新车型 -->
  <view class="section" wx:if="{{!loading && !error}}">
    <view class="section-header">
      <text class="section-title">最新车型</text>
      <text class="section-more" bindtap="onSearch">查看更多</text>
    </view>
    <view class="models-grid">
      <view 
        class="model-card" 
        wx:for="{{latestModels}}" 
        wx:key="id"
        bindtap="viewModelDetail"
        data-id="{{item.id}}"
      >
        <image 
          class="model-image" 
          src="{{item.Images && item.Images[0] ? item.Images[0].url : '/images/default-model.png'}}"
          mode="aspectFill"
          lazy-load="{{true}}"
        />
        <view class="model-info">
          <text class="model-name">{{item.name}}</text>
          <text class="model-brand">{{item.Brand ? item.Brand.name : '未知品牌'}}</text>
        </view>
      </view>
    </view>
  </view>
</view>

