// è¡¨æƒ…æ˜ å°„è¡¨
const emojiMap = {
  // ç¬‘è„¸ç±»
  'ğŸ˜€': 'ğŸ˜€', 'ğŸ˜': 'ğŸ˜', 'ğŸ˜‚': 'ğŸ˜‚', 'ğŸ¤£': 'ğŸ¤£', 'ğŸ˜ƒ': 'ğŸ˜ƒ', 'ğŸ˜„': 'ğŸ˜„',
  'ğŸ˜…': 'ğŸ˜…', 'ğŸ˜†': 'ğŸ˜†', 'ğŸ˜‰': 'ğŸ˜‰', 'ğŸ˜Š': 'ğŸ˜Š', 'ğŸ˜‹': 'ğŸ˜‹', 'ğŸ˜': 'ğŸ˜',
  'ğŸ˜': 'ğŸ˜', 'ğŸ˜˜': 'ğŸ˜˜', 'ğŸ¥°': 'ğŸ¥°', 'ğŸ˜—': 'ğŸ˜—', 'ğŸ˜™': 'ğŸ˜™', 'ğŸ˜š': 'ğŸ˜š',
  'ğŸ™‚': 'ğŸ™‚', 'ğŸ¤—': 'ğŸ¤—', 'ğŸ¤©': 'ğŸ¤©', 'ğŸ¤”': 'ğŸ¤”', 'ğŸ¤¨': 'ğŸ¤¨', 'ğŸ˜': 'ğŸ˜',
  'ğŸ˜‘': 'ğŸ˜‘', 'ğŸ˜¶': 'ğŸ˜¶', 'ğŸ™„': 'ğŸ™„', 'ğŸ˜': 'ğŸ˜', 'ğŸ˜£': 'ğŸ˜£', 'ğŸ˜¥': 'ğŸ˜¥',
  'ğŸ˜®': 'ğŸ˜®', 'ğŸ¤': 'ğŸ¤', 'ğŸ˜¯': 'ğŸ˜¯', 'ğŸ˜ª': 'ğŸ˜ª', 'ğŸ˜«': 'ğŸ˜«', 'ğŸ˜´': 'ğŸ˜´',
  'ğŸ˜Œ': 'ğŸ˜Œ', 'ğŸ˜›': 'ğŸ˜›', 'ğŸ˜œ': 'ğŸ˜œ', 'ğŸ˜': 'ğŸ˜',
  
  // æ‰‹åŠ¿ç±»
  'ğŸ‘': 'ğŸ‘', 'ğŸ‘': 'ğŸ‘', 'ğŸ‘Œ': 'ğŸ‘Œ', 'âœŒï¸': 'âœŒï¸', 'ğŸ¤': 'ğŸ¤', 'ğŸ¤Ÿ': 'ğŸ¤Ÿ',
  'ğŸ¤˜': 'ğŸ¤˜', 'ğŸ¤™': 'ğŸ¤™', 'ğŸ‘ˆ': 'ğŸ‘ˆ', 'ğŸ‘‰': 'ğŸ‘‰', 'ğŸ‘†': 'ğŸ‘†', 'ğŸ–•': 'ğŸ–•',
  'ğŸ‘‡': 'ğŸ‘‡', 'â˜ï¸': 'â˜ï¸', 'ğŸ‘‹': 'ğŸ‘‹', 'ğŸ¤š': 'ğŸ¤š', 'ğŸ–ï¸': 'ğŸ–ï¸', 'âœ‹': 'âœ‹',
  'ğŸ––': 'ğŸ––', 'ğŸ‘': 'ğŸ‘', 'ğŸ™Œ': 'ğŸ™Œ', 'ğŸ¤²': 'ğŸ¤²', 'ğŸ¤': 'ğŸ¤', 'ğŸ™': 'ğŸ™',
  'âœï¸': 'âœï¸', 'ğŸ’ª': 'ğŸ’ª', 'ğŸ¦µ': 'ğŸ¦µ', 'ğŸ¦¶': 'ğŸ¦¶', 'ğŸ‘‚': 'ğŸ‘‚', 'ğŸ¦»': 'ğŸ¦»',
  
  // åŠ¨ç‰©ç±»
  'ğŸ¶': 'ğŸ¶', 'ğŸ±': 'ğŸ±', 'ğŸ­': 'ğŸ­', 'ğŸ¹': 'ğŸ¹', 'ğŸ°': 'ğŸ°', 'ğŸ¦Š': 'ğŸ¦Š',
  'ğŸ»': 'ğŸ»', 'ğŸ¼': 'ğŸ¼', 'ğŸ¨': 'ğŸ¨', 'ğŸ¯': 'ğŸ¯', 'ğŸ¦': 'ğŸ¦', 'ğŸ®': 'ğŸ®',
  'ğŸ·': 'ğŸ·', 'ğŸ½': 'ğŸ½', 'ğŸ¸': 'ğŸ¸', 'ğŸµ': 'ğŸµ', 'ğŸ™ˆ': 'ğŸ™ˆ', 'ğŸ™‰': 'ğŸ™‰',
  'ğŸ™Š': 'ğŸ™Š', 'ğŸ’': 'ğŸ’', 'ğŸ”': 'ğŸ”', 'ğŸ§': 'ğŸ§', 'ğŸ¦': 'ğŸ¦', 'ğŸ¤': 'ğŸ¤',
  'ğŸ£': 'ğŸ£', 'ğŸ¥': 'ğŸ¥', 'ğŸ¦†': 'ğŸ¦†', 'ğŸ¦¢': 'ğŸ¦¢', 'ğŸ¦…': 'ğŸ¦…', 'ğŸ¦‰': 'ğŸ¦‰',
  
  // é£Ÿç‰©ç±»
  'ğŸ': 'ğŸ', 'ğŸŠ': 'ğŸŠ', 'ğŸ‹': 'ğŸ‹', 'ğŸŒ': 'ğŸŒ', 'ğŸ‰': 'ğŸ‰', 'ğŸ‡': 'ğŸ‡',
  'ğŸ“': 'ğŸ“', 'ğŸ«': 'ğŸ«', 'ğŸˆ': 'ğŸˆ', 'ğŸ’': 'ğŸ’', 'ğŸ‘': 'ğŸ‘', 'ğŸ¥­': 'ğŸ¥­',
  'ğŸ': 'ğŸ', 'ğŸ¥¥': 'ğŸ¥¥', 'ğŸ¥': 'ğŸ¥', 'ğŸ…': 'ğŸ…', 'ğŸ†': 'ğŸ†', 'ğŸ¥‘': 'ğŸ¥‘',
  'ğŸ¥¦': 'ğŸ¥¦', 'ğŸ¥’': 'ğŸ¥’', 'ğŸ¥¬': 'ğŸ¥¬', 'ğŸŒ¶ï¸': 'ğŸŒ¶ï¸', 'ğŸ«‘': 'ğŸ«‘', 'ğŸŒ½': 'ğŸŒ½',
  'ğŸ¥•': 'ğŸ¥•', 'ğŸ«’': 'ğŸ«’', 'ğŸ§„': 'ğŸ§„', 'ğŸ§…': 'ğŸ§…', 'ğŸ¥”': 'ğŸ¥”', 'ğŸ ': 'ğŸ ',
  
  // æ´»åŠ¨ç±»
  'âš½': 'âš½', 'ğŸ€': 'ğŸ€', 'ğŸˆ': 'ğŸˆ', 'âš¾': 'âš¾', 'ğŸ¥': 'ğŸ¥', 'ğŸ¾': 'ğŸ¾',
  'ğŸ': 'ğŸ', 'ğŸ‰': 'ğŸ‰', 'ğŸ¥': 'ğŸ¥', 'ğŸ±': 'ğŸ±', 'ğŸª€': 'ğŸª€', 'ğŸ“': 'ğŸ“',
  'ğŸ¸': 'ğŸ¸', 'ğŸ’': 'ğŸ’', 'ğŸ‘': 'ğŸ‘', 'ğŸ¥': 'ğŸ¥', 'ğŸ': 'ğŸ', 'ğŸªƒ': 'ğŸªƒ',
  'ğŸ¥…': 'ğŸ¥…', 'â›³': 'â›³', 'ğŸª': 'ğŸª', 'ğŸ¹': 'ğŸ¹', 'ğŸ£': 'ğŸ£', 'ğŸ¤¿': 'ğŸ¤¿',
  'ğŸ¥Š': 'ğŸ¥Š', 'ğŸ¥‹': 'ğŸ¥‹', 'ğŸ½': 'ğŸ½', 'ğŸ›¹': 'ğŸ›¹', 'ğŸ›·': 'ğŸ›·', 'â›¸ï¸': 'â›¸ï¸',
  
  // ç¬¦å·ç±»
  'â¤ï¸': 'â¤ï¸', 'ğŸ§¡': 'ğŸ§¡', 'ğŸ’›': 'ğŸ’›', 'ğŸ’š': 'ğŸ’š', 'ğŸ’™': 'ğŸ’™', 'ğŸ’œ': 'ğŸ’œ',
  'ğŸ–¤': 'ğŸ–¤', 'ğŸ¤': 'ğŸ¤', 'ğŸ¤': 'ğŸ¤', 'ğŸ’”': 'ğŸ’”', 'â£ï¸': 'â£ï¸', 'ğŸ’•': 'ğŸ’•',
  'ğŸ’': 'ğŸ’', 'ğŸ’“': 'ğŸ’“', 'ğŸ’—': 'ğŸ’—', 'ğŸ’–': 'ğŸ’–', 'ğŸ’˜': 'ğŸ’˜', 'ğŸ’': 'ğŸ’',
  'ğŸ’Ÿ': 'ğŸ’Ÿ', 'â˜®ï¸': 'â˜®ï¸', 'âœï¸': 'âœï¸', 'â˜ªï¸': 'â˜ªï¸', 'ğŸ•‰ï¸': 'ğŸ•‰ï¸', 'â˜¸ï¸': 'â˜¸ï¸',
  'âœ¡ï¸': 'âœ¡ï¸', 'ğŸ”¯': 'ğŸ”¯', 'ğŸ•': 'ğŸ•', 'â˜¯ï¸': 'â˜¯ï¸', 'â˜¦ï¸': 'â˜¦ï¸', 'ğŸ›': 'ğŸ›'
}

// è¡¨æƒ…æ­£åˆ™è¡¨è¾¾å¼
const emojiRegex = new RegExp(
  Object.keys(emojiMap).map(emoji => 
    emoji.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')
  ).join('|'), 
  'g'
)

/**
 * å°†æ–‡æœ¬ä¸­çš„è¡¨æƒ…è½¬æ¢ä¸ºHTML
 * @param {string} text - åŒ…å«è¡¨æƒ…çš„æ–‡æœ¬
 * @returns {string} - è½¬æ¢åçš„HTMLå­—ç¬¦ä¸²
 */
export function parseEmojiToHtml(text) {
  if (!text) return text
  
  return text.replace(emojiRegex, (match) => {
    return `<span class="emoji-text" title="${getEmojiName(match)}">${match}</span>`
  })
}

/**
 * æ£€æŸ¥æ–‡æœ¬æ˜¯å¦åŒ…å«è¡¨æƒ…
 * @param {string} text - è¦æ£€æŸ¥çš„æ–‡æœ¬
 * @returns {boolean} - æ˜¯å¦åŒ…å«è¡¨æƒ…
 */
export function hasEmoji(text) {
  if (!text) return false
  return emojiRegex.test(text)
}

/**
 * è·å–è¡¨æƒ…åç§°
 * @param {string} emoji - è¡¨æƒ…ç¬¦å·
 * @returns {string} - è¡¨æƒ…åç§°
 */
export function getEmojiName(emoji) {
  const emojiNames = {
    'ğŸ˜€': 'å¤§ç¬‘',
    'ğŸ˜': 'éœ²é½¿ç¬‘',
    'ğŸ˜‚': 'ç¬‘å“­',
    'ğŸ¤£': 'æ»¡åœ°æ‰“æ»š',
    'ğŸ˜ƒ': 'å¼€å¿ƒ',
    'ğŸ˜„': 'é«˜å…´',
    'ğŸ˜…': 'è‹¦ç¬‘',
    'ğŸ˜†': 'çœ¯çœ¼ç¬‘',
    'ğŸ˜‰': 'çœ¨çœ¼',
    'ğŸ˜Š': 'å¾®ç¬‘',
    'ğŸ˜‹': 'èˆ”å˜´',
    'ğŸ˜': 'é…·',
    'ğŸ˜': 'èŠ±ç—´',
    'ğŸ˜˜': 'é£å»',
    'ğŸ¥°': 'çˆ±å¿ƒçœ¼',
    'ğŸ‘': 'èµ',
    'ğŸ‘': 'è¸©',
    'ğŸ‘Œ': 'OK',
    'âœŒï¸': 'èƒœåˆ©',
    'ğŸ¤': 'ç¥ˆç¥·',
    'ğŸ‘': 'é¼“æŒ',
    'ğŸ™': 'ç¥ˆç¥·',
    'ğŸ’ª': 'è‚Œè‚‰',
    'â¤ï¸': 'çº¢å¿ƒ',
    'ğŸ’”': 'å¿ƒç¢',
    'ğŸ’•': 'ä¸¤å¿ƒ',
    'ğŸ’–': 'é—ªå¿ƒ',
    'ğŸ’—': 'çˆ±å¿ƒ',
    'ğŸ’˜': 'ä¸˜æ¯”ç‰¹',
    'ğŸ¶': 'å°ç‹—',
    'ğŸ±': 'å°çŒ«',
    'ğŸ­': 'å°é¼ ',
    'ğŸ¹': 'ä»“é¼ ',
    'ğŸ°': 'å…”å­',
    'ğŸ¦Š': 'ç‹ç‹¸',
    'ğŸ»': 'ç†Š',
    'ğŸ¼': 'ç†ŠçŒ«',
    'ğŸ¨': 'è€ƒæ‹‰',
    'ğŸ¯': 'è€è™',
    'ğŸ¦': 'ç‹®å­',
    'ğŸ®': 'ç‰›',
    'ğŸ·': 'çŒª',
    'ğŸ¸': 'é’è›™',
    'ğŸµ': 'çŒ´å­',
    'ğŸ': 'è‹¹æœ',
    'ğŸŠ': 'æ©™å­',
    'ğŸ‹': 'æŸ æª¬',
    'ğŸŒ': 'é¦™è•‰',
    'ğŸ‰': 'è¥¿ç“œ',
    'ğŸ‡': 'è‘¡è„',
    'ğŸ“': 'è‰è“',
    'âš½': 'è¶³çƒ',
    'ğŸ€': 'ç¯®çƒ',
    'ğŸˆ': 'æ©„æ¦„çƒ',
    'âš¾': 'æ£’çƒ',
    'ğŸ¾': 'ç½‘çƒ'
  }
  return emojiNames[emoji] || emoji
}

/**
 * ç»Ÿè®¡æ–‡æœ¬ä¸­çš„è¡¨æƒ…æ•°é‡
 * @param {string} text - è¦ç»Ÿè®¡çš„æ–‡æœ¬
 * @returns {number} - è¡¨æƒ…æ•°é‡
 */
export function countEmojis(text) {
  if (!text) return 0
  const matches = text.match(emojiRegex)
  return matches ? matches.length : 0
}

/**
 * ç§»é™¤æ–‡æœ¬ä¸­çš„è¡¨æƒ…
 * @param {string} text - åŒ…å«è¡¨æƒ…çš„æ–‡æœ¬
 * @returns {string} - ç§»é™¤è¡¨æƒ…åçš„æ–‡æœ¬
 */
export function removeEmojis(text) {
  if (!text) return text
  return text.replace(emojiRegex, '').replace(/\s+/g, ' ').trim()
}

/**
 * æ’å…¥è¡¨æƒ…åˆ°æ–‡æœ¬çš„æŒ‡å®šä½ç½®
 * @param {string} text - åŸæ–‡æœ¬
 * @param {string} emoji - è¦æ’å…¥çš„è¡¨æƒ…
 * @param {number} position - æ’å…¥ä½ç½®
 * @returns {string} - æ’å…¥è¡¨æƒ…åçš„æ–‡æœ¬
 */
export function insertEmojiAtPosition(text, emoji, position) {
  if (!text) return emoji
  return text.slice(0, position) + emoji + text.slice(position)
}

export default {
  parseEmojiToHtml,
  hasEmoji,
  getEmojiName,
  countEmojis,
  removeEmojis,
  insertEmojiAtPosition
} 