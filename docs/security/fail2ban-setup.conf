# Fail2ban配置文件
# 用于自动检测和封禁恶意访问IP
# 安装位置: /etc/fail2ban/jail.d/cardesignspace.conf

[DEFAULT]
# 全局配置
bantime = 3600         # 封禁时间：1小时
findtime = 600         # 检测时间窗口：10分钟
maxretry = 3           # 最大尝试次数
backend = auto

# ==========================================
# CarDesignSpace - Nginx 恶意访问防护
# ==========================================
[cardesignspace-malicious]
enabled = true
port = http,https
filter = cardesignspace-malicious
logpath = /var/log/nginx/cardesignspace_access.log
          /var/log/nginx/cardesignspace_error.log
maxretry = 2
bantime = 7200         # 2小时
findtime = 300         # 5分钟

# ==========================================
# CarDesignSpace - 敏感文件访问
# ==========================================
[cardesignspace-sensitive]
enabled = true
port = http,https
filter = cardesignspace-sensitive
logpath = /var/log/nginx/cardesignspace_access.log
maxretry = 1           # 一次就封禁
bantime = 86400        # 24小时
findtime = 600

# ==========================================
# CarDesignSpace - API频率限制
# ==========================================
[cardesignspace-api-limit]
enabled = true
port = http,https
filter = cardesignspace-api-limit
logpath = /var/log/nginx/cardesignspace_error.log
maxretry = 10
bantime = 1800         # 30分钟
findtime = 60

# ==========================================
# CarDesignSpace - 暴力破解防护
# ==========================================
[cardesignspace-bruteforce]
enabled = true
port = http,https
filter = cardesignspace-bruteforce
logpath = /var/log/nginx/cardesignspace_access.log
maxretry = 5
bantime = 3600
findtime = 300








