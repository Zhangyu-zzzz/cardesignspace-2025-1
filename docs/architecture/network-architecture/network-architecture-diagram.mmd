graph TB
    subgraph "本地网络环境 (192.168.31.0/24)"
        subgraph "小米路由器 AX3000<br/>192.168.31.1"
            ROUTER["小米路由器 AX3000<br/>网关: 192.168.31.1<br/>无端口转发配置"]
        end
        
        subgraph "Dell工作站<br/>BM-Precision7560<br/>192.168.31.119"
            DELL["Dell PC (Windows)<br/>IP: 192.168.31.119<br/>用户: dell<br/>有线连接"]
            DELL_FRPC["frp客户端<br/>frpc-dell.toml"]
            
            subgraph "Dell本地服务"
                PPT_FE["小秘书PPT前端<br/>Office.js侧加载项<br/>端口: 2342<br/>→ 云端: 44300"]
                PPT_BE["小秘书PPT后端<br/>API服务<br/>端口: 2343<br/>→ 云端: 44301"]
                PERSONAL["个人网站<br/>端口: 2344<br/>→ 云端: 44302<br/>(待开发)"]
                COMFYUI["ComfyUI<br/>图像处理服务<br/>端口: 2345<br/>→ 云端: 44305"]
                RDP["远程桌面<br/>端口: 3380<br/>→ 云端: 41429"]
                STATIC["静态文件服务<br/>C:/Users/dell/Desktop/share<br/>→ 云端: 6443"]
            end
        end
        
        subgraph "群晖NAS<br/>BM_NAS<br/>192.168.31.150"
            NAS["群晖 DSM 7.x<br/>主IP: 192.168.31.150<br/>辅IP: 192.168.1.3<br/>IPv6: 2408:820c:8238:da50::150<br/>有线连接"]
            NAS_FRPC["frp客户端<br/>frpc.toml"]
            
            subgraph "NAS服务"
                DSM["DSM管理界面<br/>端口: 5000/5001"]
                WEBSTATION["Web Station<br/>nginx反向代理<br/>端口: 80/443"]
                DOCKER["Docker Engine 24.0.2"]
                
                subgraph "Docker容器"
                    MINIO["MinIO对象存储<br/>S3 API: 9000 → 39000<br/>Web Console: 9001 → 39001<br/>存储: /volume1/docker/minio-data<br/>ACCESS_KEY: 2ajE2U8***"]
                    DOCVIEWER["Synology DocViewer<br/>(2个实例运行中)"]
                end
            end
        end
    end
    
    subgraph "腾讯云轻量服务器<br/>124.221.249.173"
        CLOUD["腾讯云 Lighthouse<br/>实例: lhins-0ouh7c6a<br/>公网IP: 124.221.249.173"]
        
        subgraph "云端服务"
            FRPS["frp服务器<br/>控制端口: 7000<br/>管理面板: 5443<br/>用户: birdmanoutman<br/>令牌: SFPcohVhPSlzbovC"]
            NGINX_CLOUD["Nginx反向代理<br/>配置: /etc/nginx/conf.d/<br/>SSL: 自动管理"]
            
            subgraph "端口映射服务"
                CLOUD_RDP["Dell RDP<br/>端口: 41429"]
                CLOUD_PPT_FE["小秘书PPT前端<br/>端口: 44300"]
                CLOUD_PPT_BE["小秘书PPT后端<br/>端口: 44301"]
                CLOUD_PERSONAL["个人网站<br/>端口: 44302"]
                CLOUD_COMFYUI["ComfyUI服务<br/>端口: 44305"]
                CLOUD_STATIC["静态文件<br/>端口: 6443"]
                CLOUD_MINIO_S3["MinIO S3<br/>端口: 39000"]
                CLOUD_MINIO_WEB["MinIO Console<br/>端口: 39001"]
                CLOUD_WEB["Web服务<br/>端口: 80/443"]
            end
        end
    end
    
    subgraph "DNS解析系统 (腾讯云DNSPod)"
        DNSPOD["腾讯云DNSPod<br/>DNS解析服务"]
        
        subgraph "域名配置"
            DOMAIN1["birdmanoutman.com<br/>@ A 124.221.249.173<br/>www A 124.221.249.173<br/>nas AAAA 2408:820c:8238:da50::150"]
            DOMAIN2["xiaomishuppt.com<br/>@ A 124.221.249.173<br/>www A 124.221.249.173<br/>邮箱: QQ企业邮箱<br/>MX: mxbiz1.qq.com (5)<br/>MX: mxbiz2.qq.com (10)"]
            DOMAIN3["maydayland.fans<br/>仅NS记录<br/>暂无A记录解析"]
            DOMAIN4["birdmanoutman.synology.me<br/>群晖DDNS<br/>→ 124.221.249.173"]
        end
    end
    
    subgraph "外网访问"
        INTERNET["互联网用户"]
        subgraph "访问方式"
            HTTP_ACCESS["HTTP/HTTPS访问<br/>通过域名<br/>经腾讯云代理"]
            IPV6_ACCESS["IPv6直连<br/>nas.birdmanoutman.com<br/>低延迟访问"]
            FRP_ACCESS["frp隧道<br/>跨网络访问<br/>认证加密"]
        end
    end
    
    %% 内网连接关系
    DELL -.->|"有线千兆连接"| ROUTER
    NAS -.->|"有线千兆连接"| ROUTER
    
    %% frp隧道连接
    DELL_FRPC ==>|"frp隧道<br/>TLS加密<br/>令牌认证"| FRPS
    NAS_FRPC ==>|"frp隧道<br/>TLS加密<br/>令牌认证"| FRPS
    
    %% Dell服务映射
    PPT_FE --> DELL_FRPC
    PPT_BE --> DELL_FRPC
    PERSONAL --> DELL_FRPC
    COMFYUI --> DELL_FRPC
    RDP --> DELL_FRPC
    STATIC --> DELL_FRPC
    
    %% NAS服务映射
    MINIO --> NAS_FRPC
    DSM --> NAS_FRPC
    WEBSTATION --> NAS_FRPC
    
    %% 云端服务映射
    FRPS --> CLOUD_RDP
    FRPS --> CLOUD_PPT_FE
    FRPS --> CLOUD_PPT_BE
    FRPS --> CLOUD_PERSONAL
    FRPS --> CLOUD_COMFYUI
    FRPS --> CLOUD_STATIC
    FRPS --> CLOUD_MINIO_S3
    FRPS --> CLOUD_MINIO_WEB
    FRPS --> CLOUD_WEB
    
    %% DNS解析连接
    INTERNET --> DNSPOD
    DNSPOD --> DOMAIN1
    DNSPOD --> DOMAIN2
    DNSPOD --> DOMAIN3
    DNSPOD --> DOMAIN4
    
    %% 外网访问路径
    HTTP_ACCESS --> NGINX_CLOUD
    NGINX_CLOUD --> CLOUD_PPT_FE
    NGINX_CLOUD --> CLOUD_PPT_BE
    NGINX_CLOUD --> CLOUD_PERSONAL
    
    IPV6_ACCESS -.->|"IPv6直连<br/>绕过云端代理"| NAS
    FRP_ACCESS --> FRPS
    
    %% Docker内部关系
    DOCKER --> MINIO
    DOCKER --> DOCVIEWER
    
    %% Web Station到MinIO的反向代理
    WEBSTATION -.->|"计划中的反向代理<br/>替代frp映射"| MINIO
    
    %% 数据流标注
    MINIO -.->|"S3对象存储<br/>图片/文件服务"| COMFYUI
    COMFYUI -.->|"图像处理服务"| PPT_BE
    PPT_BE -.->|"API调用"| PPT_FE
    
    %% 样式定义
    classDef localDevice fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#000
    classDef cloudDevice fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#000
    classDef service fill:#f3e5f5,stroke:#7b1fa2,stroke-width:1px,color:#000
    classDef network fill:#e8f5e8,stroke:#388e3c,stroke-width:2px,color:#000
    classDef domain fill:#fff8e1,stroke:#ffa000,stroke-width:1px,color:#000
    classDef container fill:#e0f2f1,stroke:#00695c,stroke-width:1px,color:#000
    classDef router fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#000
    classDef critical fill:#ffebee,stroke:#d32f2f,stroke-width:2px,color:#000
    
    class DELL,NAS localDevice
    class CLOUD,FRPS,NGINX_CLOUD cloudDevice
    class PPT_FE,PPT_BE,PERSONAL,COMFYUI,RDP,STATIC,DSM,WEBSTATION,DELL_FRPC,NAS_FRPC service
    class INTERNET,HTTP_ACCESS,IPV6_ACCESS,FRP_ACCESS,DNSPOD network
    class DOMAIN1,DOMAIN2,DOMAIN3,DOMAIN4 domain
    class MINIO,DOCVIEWER,DOCKER container
    class ROUTER router
    class CLOUD_RDP,CLOUD_PPT_FE,CLOUD_PPT_BE,CLOUD_PERSONAL,CLOUD_COMFYUI,CLOUD_STATIC,CLOUD_MINIO_S3,CLOUD_MINIO_WEB,CLOUD_WEB critical
