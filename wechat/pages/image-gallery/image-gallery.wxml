<!--pages/image-gallery/image-gallery.wxml-->
<view class="image-gallery-page">
  <!-- 加载状态 -->
  <view class="loading-container" wx:if="{{loading && images.length === 0}}">
    <view class="loading">
      <text class="loading-text">加载中...</text>
    </view>
  </view>

  <!-- 错误状态 -->
  <view class="error-container" wx:if="{{error && images.length === 0}}">
    <view class="error">
      <text class="error-text">{{error}}</text>
      <button class="btn-primary mt-20" bindtap="loadImages">重试</button>
    </view>
  </view>

  <!-- 图片网格 -->
  <view class="images-grid" wx:if="{{images.length > 0}}">
    <view 
      class="image-item" 
      wx:for="{{images}}" 
      wx:key="_key"
      bindtap="previewImage"
      data-index="{{index}}"
    >
      <image 
        class="image" 
        src="{{item.url || item.image_url || item.displayUrl || ''}}"
        mode="aspectFill"
        lazy-load="{{true}}"
        binderror="onImageError"
        bindload="onImageLoad"
        data-index="{{index}}"
      />
      <!-- 加载失败占位符 -->
      <view class="image-placeholder" wx:if="{{item._error}}">
        <text class="placeholder-text">加载失败</text>
      </view>
    </view>
  </view>

  <!-- 加载更多 -->
  <view class="load-more-container" wx:if="{{images.length > 0}}">
    <view class="load-more" wx:if="{{loadingMore}}">
      <text class="load-more-text">加载中...</text>
    </view>
    <view class="no-more" wx:elif="{{!hasMore}}">
      <text class="no-more-text">没有更多了</text>
    </view>
  </view>
</view>

